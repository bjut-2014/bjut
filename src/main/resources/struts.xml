<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE struts PUBLIC
	"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
	"http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>

	<constant name="struts.enable.DynamicMethodInvocation" value="false" />
	<constant name="struts.devMode" value="true" />

	<!-- 把struts的请求委托给spring管理, 作用:创建Action实例的过程由spring处理,其他的还是有struts2自己处理 -->
	<constant name="struts.objectFactory" value="spring" />
	<!-- 去掉请求url中的‘.action’后缀 -->
	<constant name="struts.action.extension" value="," />

	<package name="default" namespace="/" extends="struts-default">

		<!-- session过期拦截器 -->
		<interceptors>
			<interceptor name="loginedCheck"
				class="cn.internship.interceptor.LoginedCheckInterceptor" />
			<interceptor-stack name="mystack">
				<interceptor-ref name="loginedCheck" />
				<interceptor-ref name="defaultStack">
				</interceptor-ref>
			</interceptor-stack>
		</interceptors>
		<!-- end -->
		
		<!-- 所有的action都配置一个拦截器 -->
		<default-interceptor-ref name="mystack">
		</default-interceptor-ref>
		<!-- end -->
		
		<!-- 定义全局result -->
		<global-results>
			<result name="tologin" type="redirect">/login.jsp</result>
		</global-results>
		<!-- end -->

		<!-- 验证码 -->
		<action name="verifyCodeAction" class="verifyCodeAction">
			<result name="success" type="stream">
				<param name="contentType">image/jpeg</param>
				<param name="inputName">inputStream</param>
			</result>
		</action>
		<!-- end -->

		<!-- 登陆 -->
		<action name="login" class="loginAction">
			<result name="success" type="redirectAction">index</result>
			
			<result name="input">/login.jsp</result>
		</action>
		<!-- end -->
		<!-- 注销 -->
		<action name="logout" class="loginAction" method="logout">
			<result name="logout">/login.jsp</result>
		</action>
		<!-- end -->
		<!-- 学生相关操作 -->
		<action name="index" class="studentAction">
			<result>/WEB-INF/views/index.jsp</result>
		</action>
		<!-- end -->
		
		<!-- 老师下载实习报告 -->
		
		<action name="internship-report-download" class="fileDownloadAction">  
			<result name="FileNotFound">/WEB-INF/views/error/FileNotFound.jsp</result>
			<result name="success" type="stream">
				<param name="contentType">*</param>
				<param name="contentDisposition">attachment;filename="${fileName}"</param>
				<param name="inputName">downloadFile</param>
				<param name="bufferSize">81920</param>
			</result>  
       </action>  
		
		<!-- end -->
		
		<!-- 教师实习周报 -->
		
		<action name="teacher-weekly-report" class="teacher-weekly-report">
			<result>/WEB-INF/views/teacher/t_internship.jsp</result>
		</action>
		<action name="teacher-weekly-report-all" class="teacher-weekly-report" method="getOneStudentWeeklyReports">
			<result>/WEB-INF/views/teacher/t_internship_all.jsp</result>
		</action>
		<action name="teacher-weekly-report-view" class="teacher-weekly-report" method="queryOneWeeklyReport">
			<result>/WEB-INF/views/teacher/t_internship_view.jsp</result>
		</action>
		
		<!-- end -->
		
		<!-- 教师毕设周报 -->
		
		<action name="teacher-graduation-weekly-report" class="teacher-graduation-weekly-report">
			<result>/WEB-INF/views/teacher/t_graduation.jsp</result>
		</action>
		<action name="teacher-graduation-weekly-report-all" class="teacher-graduation-weekly-report" method="getOneStudentWeeklyReports">
			<result>/WEB-INF/views/teacher/t_graduation_all.jsp</result>
		</action>
		<action name="teacher-graduation-weekly-report-view" class="teacher-graduation-weekly-report" method="queryOneWeeklyReport">
			<result>/WEB-INF/views/teacher/t_graduation_view.jsp</result>
		</action>
		
		<!-- end -->
		
	</package>


</struts>
